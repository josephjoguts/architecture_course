

## Задание 1

Выполнил **уровень 1 и уровень 2**
Для выполнения этого задания можно выбрать, как SingleSpa, так и ModuleFederation. Я считаю, что следует выбрать SingleSpa, документация этого фреймворка показалась мне более приятной.

Разбил монолит на 5 микрофронтов:
#### Root
Этот микрофронтед основной. Отвечает за тело сайта и routing
#### Auth-microfrontend
Этот микрофронтенд отвечает за регистрацию и авторизацию
#### Profile-microfrontend
Этот микрофронтенд отвечает за настройку и просмотр профиля пользователя
#### New-content-microfrontend
Этот микрофронтенд отвечает за добавление контента на страницу в *следующий фронтенд*
#### Display-microfrontend
Этот микрофронтенд отвечает за отображение карточек фотографий на странице


##### Метод реализации
Считаю, что для этого проекта подойдет Run time c композицией на клиентской стороне.
У нас приложение, в котором много интерактивного контента: что-то будет двигаться, будут добавляться новые карты, пользователи будут ставить лайки, обновляться лента и т.д.


## Задание 2

Выполняя это задание, я брал действия монолита и определял их в подходящий микросервис.
Итого получилось несколько блоков - request handle services, core сервисы и util сервисы.


**Request handle services** блок состоит из четверки которая отвественна за передачу запросов от пользователя до наших микросервисов. Фронтенд, nginx, api-gateway.

#### Core services

**Auth service** - отвечает за регистрацию/аутентификацию и права пользователя

**TechSupport service** - Сервис поддержки, отвечающей за торговую площадку

**Product service** - редактор  товаров и каталог товаров
**Favor service** -  редактор  товаров и каталог услуг
**Cart service** - сервис корзины пользователя

**Order history service** - отвественнен за хранение истории и результатов продажи товаров, участия в аукционах
**Export service** - занимается отчетами, связываясь с order history service. Изначально был util сервисом, но попал в коровые из-за важности

**Order Catalog service** - Каталог заказов и редактор создания заказа и часть личного кабинета пользователя. При создании заказа опционально предлагаем пользователю потенциальные подходящие услуги или товары из Favor Catalog service.

**Auction Manager service** - редактор создания аукциона и часть личного кабинета пользователя, каталог аукционов и менеджер ставок на эти аукционы

**Payment Gateway service** - платежный шлюз, отвечающий за взаимодействие с транзакциями пользователей, на аукционе или торговой площадке


#### Util services
**Notification service** - асинхронно принимает запросы от сервисов на отправку нотификаций пользователю
**Logging, monitoring services** - сервисы отвечающие за сбор информации по приложению Grafana, ElasticSearch etc.

#### Описание потоков
- А1 - Передать запрос в Auth Service для расшифровки Jwt токена и получения пользователя.

- Г1 - Api gateway должен передать запрос  в необходимый сервис вместе с пользователем из А1.

- З1 - Проверить, есть ли в каталоге услуг подходящяя по создаваемой.

- У1 - Добавить услугу в корзину
- П1 - Добавить товар в корзину

- К1 - начать оплату корзины, передать сумму товаров в платежный шлюз
- К2 - Отправить заказ в сервис истории через кафку
- К3 - Добавить информацию о заказе в сервис истории

- Ш1 - Зарегистрировать заказ во внешней платежной системе
- Ш2 - Получить callback о статусе транзакции от платежки
- Ш3 - Отправить информацию о состоянии заказа в сервис истории
- Ш4 - Добавить информацию в заказ, сохраненный в К3

- А1 - начать оплату ставки, передать сумму в шлюз
- А2 - Отправить информацию о ставке на аукцион или информации о создании в сервис истори
- А3 - Добавить информацию о аукционе в сервис истории

- Э1 - Получить историю о сделках и аукционах для экспорта

- Н1 - Отправить информацию о событии в кафку
- Н2 - Отдать информацию о событии в сервис нотификаций
- Н3 - Отправить уведомление необходимому пользователю

##### UPDATE AFTER REVIEW
- На схеме отсутствуют роли из изначальной схемы (админ, специалист поддержки, клиент) - **Добавил**

- На схеме не распределены изначальные сущности БД - **Добавил изначальные сущности. Но не очень понял зачем, не лучше ли сохранить абстракцию**

- Лучше явно соединить сервис с БД, чтобы не было недопонимания (бывает, что и два сервиса ходят в одну БД). Это можно сделать либо стрелками, либо логическим объединением, как на изначальной схеме или на картинке [тут](https://miro.medium.com/v2/resize:fit:720/format:webp/1*XK7hJD5gpkD1D9knUdo9zw.png) - **Соединил. Ссылка только не открывается**

- Связи и взаимодействие не прописано отдельно, как в примере. Вот только несколько вопросов, которые хочется по схеме
    - Зачем информация об аукционе кладется в кафку?
    - Почему информация об аукционе берется из сервиса истории заказов?
      **Добавил блок в readme и на схему**

- Валидацию токена вынести на уровень гейтвея. - **Добавил**

- Разделить услуги и товары по разным сервисам, так как это разные домены и логика у них может сильно отличаться. - **Разделил**

- Объединить сервисы Create order service и Order Catalog service, так как они работают с одним доменом (заказ) и не очень понятно как это все разносить по БД.
- Аналогичная история с аукционом. - **Объединил**


- Отобразить статистику заказов можно вынести в сервис экспорта. - **Добавил**

**Ссылка** https://drive.google.com/file/d/1olnOAPqA1WQoKAWiooMea5SUsehL3wIx/view?usp=sharing
